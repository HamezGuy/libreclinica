<!-- Study Group Modal --><html><head></head><body><div class="modal-overlay" *ngif="show" (click)="onBackdropClick($event)">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>
        <i class="material-icons">{{ 'study-group-modal.group' | translate }}</i>
        {{ isEditMode ? 'Edit' : 'Create' }} Study Group
        <span class="study-name" *ngif="study">for {{ study.title }}</span>
      </h2>
      <button class="close-button" (click)="onClose()" [disabled]="isSubmitting">
        <i class="material-icons">{{ 'common.close' | translate }}</i>
      </button>
    </div>
    
    <div class="modal-body">
      <form [formgroup]="groupForm" (ngsubmit)="onSubmit()">
        <div class="form-group">
          <label for="name">{{ 'study-group-modal.group_name' | translate }}<span class="required">*</span>
          </label>
          <input type="text" id="name" formcontrolname="name" class="form-control" [class.error]="groupForm.get('name')?.invalid &amp;&amp; groupForm.get('name')?.touched" :placeholder="'study-group-modal.eg_control_group_treatment_group_a' | translate">
          <div class="error-message" *ngif="groupForm.get('name')?.invalid &amp;&amp; groupForm.get('name')?.touched">
            <span *ngif="groupForm.get('name')?.errors?.['required']">{{ 'study-group-modal.group_name_is_required' | translate }}</span>
            <span *ngif="groupForm.get('name')?.errors?.['minlength']">{{ 'study-group-modal.group_name_must_be_at_least_3_characters' | translate }}</span>
          </div>
        </div>
        
        <div class="form-group">
          <label for="description">{{ 'common.description' | translate }}<span class="required">*</span>
          </label>
          <textarea id="description" formcontrolname="description" class="form-control" rows="3" [class.error]="groupForm.get('description')?.invalid &amp;&amp; groupForm.get('description')?.touched" :placeholder="'study-group-modal.describe_the_purpose_and_characteristics_of_this_g' | translate">          </textarea>
          <div class="error-message" *ngif="groupForm.get('description')?.invalid &amp;&amp; groupForm.get('description')?.touched">
            <span *ngif="groupForm.get('description')?.errors?.['required']">{{ 'study-group-modal.description_is_required' | translate }}</span>
            <span *ngif="groupForm.get('description')?.errors?.['minlength']">{{ 'study-group-modal.description_must_be_at_least_10_characters' | translate }}</span>
          </div>
        </div>
        
        <div class="form-group">
          <label for="criteria">{{ 'study-group-modal.inclusionexclusion_criteria' | translate }}<span class="required">*</span>
          </label>
          <textarea id="criteria" formcontrolname="criteria" class="form-control" rows="4" [class.error]="groupForm.get('criteria')?.invalid &amp;&amp; groupForm.get('criteria')?.touched" :placeholder="'study-group-modal.define_the_criteria_for_patient_inclusion_in_this_' | translate">          </textarea>
          <div class="error-message" *ngif="groupForm.get('criteria')?.invalid &amp;&amp; groupForm.get('criteria')?.touched">
            <span *ngif="groupForm.get('criteria')?.errors?.['required']">{{ 'study-group-modal.criteria_is_required' | translate }}</span>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="targetSize">{{ 'study-group-modal.target_size' | translate }}<span class="required">*</span>
            </label>
            <input type="number" id="targetSize" formcontrolname="targetSize" class="form-control" min="1" max="1000" [class.error]="groupForm.get('targetSize')?.invalid &amp;&amp; groupForm.get('targetSize')?.touched" :placeholder="'study-group-modal.number_of_participants' | translate">
            <div class="error-message" *ngif="groupForm.get('targetSize')?.invalid &amp;&amp; groupForm.get('targetSize')?.touched">
              <span *ngif="groupForm.get('targetSize')?.errors?.['required']">{{ 'study-group-modal.target_size_is_required' | translate }}</span>
              <span *ngif="groupForm.get('targetSize')?.errors?.['min']">{{ 'study-group-modal.target_size_must_be_at_least_1' | translate }}</span>
              <span *ngif="groupForm.get('targetSize')?.errors?.['max']">{{ 'study-group-modal.target_size_cannot_exceed_1000' | translate }}</span>
            </div>
          </div>
          
          <div class="form-group">
            <label for="status">{{ 'common.status' | translate }}<span class="required">*</span>
            </label>
            <select id="status" formcontrolname="status" class="form-control" [class.error]="groupForm.get('status')?.invalid &amp;&amp; groupForm.get('status')?.touched">
              <option value="active">{{ 'study-group-modal.active' | translate }}</option>
              <option value="inactive">{{ 'study-group-modal.inactive' | translate }}</option>
              <option value="full">{{ 'study-group-modal.full' | translate }}</option>
            </select>
            <div class="error-message" *ngif="groupForm.get('status')?.invalid &amp;&amp; groupForm.get('status')?.touched">
              <span *ngif="groupForm.get('status')?.errors?.['required']">{{ 'study-group-modal.status_is_required' | translate }}</span>
            </div>
          </div>
        </div>
        
        <div class="info-box" *ngif="group">
          <div class="info-item">
            <i class="material-icons">{{ 'study-group-modal.people' | translate }}</i>
            <span>Current Size: {{ group.currentSize || 0 }} / {{ groupForm.get('targetSize')?.value }}</span>
          </div>
          <div class="info-item">
            <i class="material-icons">{{ 'study-group-modal.event' | translate }}</i>
            <span>Created: {{ group.createdAt | date:'short' }}</span>
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="onClose()" [disabled]="isSubmitting">{{ 'common.cancel' | translate }}</button>
      <button class="btn btn-primary" (click)="onSubmit()" [disabled]="groupForm.invalid || isSubmitting">
        <span *ngif="!isSubmitting">{{ isEditMode ? 'Update' : 'Create' }} Group</span>
        <span *ngif="isSubmitting">
          <i class="material-icons spin">{{ 'common.refresh' | translate }}</i>
          {{ isEditMode ? 'Updating' : 'Creating' }}...
        </span>
      </button>
    </div>
  </div>
</div>
</body></html>