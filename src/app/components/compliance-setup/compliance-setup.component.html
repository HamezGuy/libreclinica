<html><head></head><body><div class="compliance-setup-container">
  <div class="setup-card" *ngIf="!isLoading">
    <!-- Header -->
    <div class="setup-header">
      <h1>{{ 'compliance-setup.compliance_setup' | translate }}</h1>
      <p class="subtitle">{{ 'compliance-setup.complete_the_following_requirements_to_access_the_' | translate }}</p>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
      <div class="progress-step" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1">
        <div class="step-number">1</div>
        <div class="step-label">{{ 'compliance-setup.terms_privacy' | translate }}</div>
      </div>
      <div class="progress-line" [class.completed]="currentStep > 1"></div>
      <div class="progress-step" [class.active]="currentStep >= 2" [class.completed]="currentStep > 2">
        <div class="step-number">2</div>
        <div class="step-label">{{ 'compliance-setup.training' | translate }}</div>
      </div>
    </div>

    <!-- Error Message -->
    <div class="error-message" *ngIf="error">
      <span class="error-icon">⚠️</span>
      {{ error }}
    </div>

    <!-- Step 1: Terms and Privacy -->
    <div class="setup-step" *ngIf="currentStep === 1">
      <h2>{{ 'compliance-setup.terms_of_service_privacy_policy' | translate }}</h2>
      <p class="step-description">{{ 'compliance-setup.please_review_and_accept_our_terms_of_service_and_' | translate }}</p>

      <div class="document-container">
        <div class="document-section">
          <div class="document-content" [innerHTML]="termsContent"></div>
          <label class="checkbox-label">
            <input type="checkbox" [(ngModel)]="termsAccepted">
            <span>{{ 'compliance-setup.i_have_read_and_accept_the_terms_of_service' | translate }}</span>
          </label>
        </div>

        <div class="document-section">
          <div class="document-content" [innerHTML]="privacyContent"></div>
          <label class="checkbox-label">
            <input type="checkbox" [(ngModel)]="privacyAccepted">
            <span>{{ 'compliance-setup.i_have_read_and_accept_the_privacy_policy' | translate }}</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Step 2: Training -->
    <div class="setup-step" *ngIf="currentStep === 2">
      <h2>{{ 'compliance-setup.required_training_modules' | translate }}</h2>
      <p class="step-description">{{ 'compliance-setup.complete_all_training_modules_to_ensure_compliance' | translate }}</p>

      <div class="training-modules">
        <div class="module-item" *ngFor="let module of trainingModules" [class.completed]="module.completed">
          <div class="module-info">
            <h3>{{ module.title }}</h3>
            <p class="module-duration">Duration: {{ module.duration }}</p>
          </div>
          <div class="module-action">
            <button class="module-button" *ngIf="!module.completed" (click)="completeModule(module.id)">{{ 'compliance-setup.start_module' | translate }}</button>
            <div class="completed-badge" *ngIf="module.completed">{{ 'compliance-setup._completed' | translate }}</div>
          </div>
        </div>
      </div>

      <div class="training-note">
        <p><strong>{{ 'compliance-setup.note' | translate }}</strong>{{ 'compliance-setup.in_a_production_environment_each_module_would_cont' | translate }}</p>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button class="secondary-button" (click)="logout()">{{ 'common.logout' | translate }}</button>
      <button class="primary-button" [disabled]="!canProceed || isSaving" (click)="nextStep()">
        <span *ngIf="!isSaving">
          {{ currentStep === 2 || (currentStep === 1 &amp;&amp; !requirements.needsTraining) ? 'Complete Setup' : 'Continue' }}
        </span>
        <span *ngIf="isSaving" class="spinner"></span>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>{{ 'compliance-setup.loading_compliance_requirements' | translate }}</p>
  </div>

  <!-- Background Pattern -->
  <div class="background-pattern"></div>
</div>
</body></html>