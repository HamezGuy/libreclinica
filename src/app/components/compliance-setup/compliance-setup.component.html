<div class="compliance-setup-container">
  <div class="setup-card" *ngIf="!isLoading">
    <!-- Header -->
    <div class="setup-header">
      <h1>Compliance Setup</h1>
      <p class="subtitle">Complete the following requirements to access the EDC system</p>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
      <div class="progress-step" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1">
        <div class="step-number">1</div>
        <div class="step-label">Terms & Privacy</div>
      </div>
      <div class="progress-line" [class.completed]="currentStep > 1"></div>
      <div class="progress-step" [class.active]="currentStep >= 2" [class.completed]="currentStep > 2">
        <div class="step-number">2</div>
        <div class="step-label">Training</div>
      </div>
    </div>

    <!-- Error Message -->
    <div class="error-message" *ngIf="error">
      <span class="error-icon">⚠️</span>
      {{ error }}
    </div>

    <!-- Step 1: Terms and Privacy -->
    <div class="setup-step" *ngIf="currentStep === 1">
      <h2>Terms of Service & Privacy Policy</h2>
      <p class="step-description">
        Please review and accept our terms of service and privacy policy to proceed.
      </p>

      <div class="document-container">
        <div class="document-section">
          <div class="document-content" [innerHTML]="termsContent"></div>
          <label class="checkbox-label">
            <input type="checkbox" [(ngModel)]="termsAccepted">
            <span>I have read and accept the Terms of Service</span>
          </label>
        </div>

        <div class="document-section">
          <div class="document-content" [innerHTML]="privacyContent"></div>
          <label class="checkbox-label">
            <input type="checkbox" [(ngModel)]="privacyAccepted">
            <span>I have read and accept the Privacy Policy</span>
          </label>
        </div>
      </div>
    </div>

    <!-- Step 2: Training -->
    <div class="setup-step" *ngIf="currentStep === 2">
      <h2>Required Training Modules</h2>
      <p class="step-description">
        Complete all training modules to ensure compliance with regulatory requirements.
      </p>

      <div class="training-modules">
        <div class="training-module" *ngFor="let module of trainingModules" 
             [class.completed]="module.completed">
          <div class="module-info">
            <h3>{{ module.title }}</h3>
            <p class="module-duration">Duration: {{ module.duration }}</p>
          </div>
          <div class="module-action">
            <button class="module-button" 
                    *ngIf="!module.completed"
                    (click)="completeModule(module.id)">
              Start Module
            </button>
            <div class="completed-badge" *ngIf="module.completed">
              ✓ Completed
            </div>
          </div>
        </div>
      </div>

      <div class="training-note">
        <p><strong>Note:</strong> In a production environment, each module would contain 
        interactive training content, quizzes, and assessments. For this demo, click 
        "Start Module" to mark as completed.</p>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button class="secondary-button" (click)="logout()">
        Logout
      </button>
      <button class="primary-button" 
              [disabled]="!canProceed || isSaving"
              (click)="nextStep()">
        <span *ngIf="!isSaving">
          {{ currentStep === 2 || (currentStep === 1 && !requirements.needsTraining) ? 'Complete Setup' : 'Continue' }}
        </span>
        <span *ngIf="isSaving" class="spinner"></span>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Loading compliance requirements...</p>
  </div>

  <!-- Background Pattern -->
  <div class="background-pattern"></div>
</div>
